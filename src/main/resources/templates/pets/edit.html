<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{partials/fragment.html :: head('Pet Edit')}"></head>
<head>    <script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
</head>
<body>
<nav th:replace="~{partials/fragment.html :: nav}"></nav>

<div sec:authorize="isAuthenticated()">
    This content is only shown to authenticated users.

    User ID: <span th:text="${#authentication.principal.id}"/>
    Username: <span th:text="${#authentication.principal.username}"/>
    Email: <span th:text="${#authentication.principal.email}"/>
</div>

<section class="d-flex">
<div class="mt-4 mb-4 p-4 container form-box col-12" id="pet">
    <form th:action="@{/pets/${pet.id}/edit}" th:method="post" id="postForm">
        <input type="hidden" id="post_id"  name="post_id" th:value="${post.id}">
        <input type="hidden" id="pet_id" name="pet_id" th:value="${pet.id}">
        <div class="mt-1 d-flex">
            <div class="col-6">
                <div class="label-holder">
                    <span class="label">Title:</span>
                </div>
                <div>
                    <div class="input">
                    <input class="text-input" type="text" name="title" th:value="${post.title}">
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="label-holder">
                    <span class="label">Location:</span>
                </div>
                <div>
                    <div class="input">
                        <input class="text-input" type="text" name="location" th:value="${post.location}">
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-1 d-flex">
            <div class="col-6">
                <div class="label-holder">
                    <span class="label">Name:</span>
                </div>
                <div>
                    <div class="input">
                        <input class="text-input" type="text" name="name" th:value="${pet.name}">
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="label-holder">
                    <span class="label">Size:</span>
                </div>
                <div>
                    <div class="input">
                        <input class="text-input" type="text" name="size" th:value="${pet.size}">
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-1 d-flex">
            <div class="col-6">
                <div class="label-holder">
                    <span class="label">Species:</span>
                </div>
                <div>
                    <div class="input">
                        <input class="text-input" type="text" name="species" th:value="${pet.species}">
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="label-holder">
                    <span class="label">Breed:</span>
                </div>
                <div>
                    <div class="input">
                        <input class="text-input" type="text" name="breed" th:value="${pet.breed}">
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-1 d-flex">
            <div class="col-6">
                <div class="ta-holder">
                    <span class="ta">Post-Body:</span>
                </div>
                <div>
                    <div class="input">
                        <textarea class="text-area" name="body" th:value="${post.body}"></textarea>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="ta-holder">
                    <span class="ta">Description:</span>
                </div>
                <div>
                    <div class="input">
                        <textarea class="text-area" name="description" th:value="${pet.description}"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <input id="stashFilestackURL" th:name="stashFilestackURL" th:value="replaceme" type="hidden">
            <label for="upload"></label>
            <button type="button" id="upload" name="upload" class="btn button-secondary">Upload an image</button>
        </div>
        <div class="d-flex justify-content-end">
            <button class="mt-4  button-main" type="submit">Submit</button>
        </div>
    </form>
</div>
</section>

<footer th:replace="~{partials/fragment.html :: footer}"></footer>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"
        integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g="
        crossOrigin="anonymous"></script>
<script th:inline="javascript">

    //FILESTACK ---------------------------------------------------
    $("#upload").click(function () {
        client.picker(options).open()
    });
    var filestackapi = [[${filestackapi}]];
    const client = filestack.init(filestackapi);
    const options = {
        onUploadDone:
            function(res) {
                $("#stashFilestackURL").val(res.filesUploaded[0].url);
            }
    }
</script>
</body>
</html>